<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>R6CC - Administrador</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/adm.css">
    <script src="https://kit.fontawesome.com/42d2b3af0b.js" crossorigin="anonymous"></script>
    <script src="./funcoes.js"></script>
</head>

<body>

    <header class="menu">
        <div><img src="img/logo.png" class="logo"></div>
        <ul class="l-menu">
            <li><a href="index.html" class="btn ativo">Home</a></li>
            <li><a href="lobby.html" class="btn">Procurar lobby</a></li>
            <li><a href="leaderboard.html" class="btn">Leaderboard</a></li>
            <li><a href="login.html" class="btn">Entrar/Cadastro</a></li>
            <li><a href="adm.html" class="btn" class="btn ativo">Administrador</a></li>
        </ul>
    </header>
    <hr>
    <div id="alerta">
        <div class="sino">
            <i class="far fa-bell fa-7x"></i>
        </div>

        <div class="mensagem">
            <h4>Alerta:</h4>
            <div>
                <b id="b_alerta">Aqui vai uma mensagem<b></b>
            </div>
            <div class="div_botoes">
                <button class="btn" type="submit" onclick="publicarBanco()">OK</button>
                <button class="btn" onclick="cancelar()">Cancelar</button>
            </div>
        </div>

    </div>

    <div class="bem_vindo_adm">
        <h1>Bem vindo à página do adm R6CC, {nome do adm}</h1>
    </div>
    <div class="container">
        <h2>Relembrando regras e funções:</h2>
        <ul>
            <li>Sempre verifique o <a class="discord" href="https://discord.gg/fNNKMtB">Discord <i
                        class="fab fa-discord"></i></a>!</li>
            <li>Assim que possivel faça as modificações na pontuação!</li>
            <li>Não bana jogadores sem motivo!</li>
            <li>Sempre verifique se sua alterações estão corretas!</li>
            <li>Cada partida que o jogador ganha, +6 pontos</li>
            <li>Cada partida que o jogador perde, -3 pontos</li>
            <li>Se o jogador violar as regras dê um ban (vc avalia o tempo do ban)</li>
            <li>Se o mesmo jogador insistir em violar as regras dê um ban indeterminado e zere os pontos dele</li>
        </ul>


        <div style="margin-top: 15px;">
            <h2>Alterar pontuações</h2>
            <p style="font-size: 14px;">Presta atenção no que ta fazendo!</p>
            <hr>
            <form id="form_publicar" method="POST" action="/">
                <label for="id_nick">Nickname do jogador: </label><br>
                <input type="text" name="nickname" id="id_nick">

                <div id="div_pontos" style="display: none;">
                    <label for="id_pontos">Alterar pontuação: </label><br>
                    <input type="number" name="pontuacao" id="id_pontos"> <br><br>

                </div>
            </form>
            <div id="div_botao" style="display: none;">
                <button class="btn" onclick="mostrarAlerta()">
                    Alterar pontuação!
                </button>
            </div>
            <div id="div_info">
                <button style="margin-top: 15px;" onclick="buscar()" class="btn">Buscar Jogador!</button>
            </div>

        </div>
    </div>
    

    <footer>
        <div>
            <p>Desenvolvido por Kaique F. Lucena</p>
        </div>
        <p>Minhas redes:</p>
        <ul>
            <li> <a href="https://www.linkedin.com/in/kaique-lucena-1383401a2/" target="_blank"><i
                        class="fab fa-linkedin-in"></i></a></li>
            <li> <a href="https://github.com/KaiqueFigu1" target="_blank"><i class="fab fa-github"></i></a></li>
        </ul>
    </footer>

</body>

</html>
<script>
    verificar_autenticacao();

    function buscar() {
        let divPontos = document.getElementById('div_pontos');
        let divInfo = document.getElementById('div_info');
        let divBotao = document.getElementById('div_botao');
        var formulario = new URLSearchParams(new FormData(form_publicar));
        fetch("/usuarios/procurar",
            {
                method: "POST",
                body: formulario
            }).then(function (res) {
                if (res.ok) {
                    res.json().then(function (jogador) {
                        if (jogador.length > 0) {
                            divInfo.innerHTML = "";
                            divInfo.innerHTML = `O jogador ${jogador[0].nickname} tem ${jogador[0].pontuacao} pontos`;
                            divPontos.style.display = 'block';
                            divBotao.style.display = 'block';

                        } else {
                            divInfo.innerHTML += "<br>Nenhum jogador foi encontrado :'(";
                        }

                    });

                }
            });
    }


    function publicarBanco() {
        fecharAlerta()

        var formulario = new URLSearchParams(new FormData(form_publicar));
        fetch("/usuarios/publicar",
            {
                method: "POST",
                body: formulario
            }).then(function (res) {
                if (res.ok) {
                    let Nickname = document.getElementById('id_nick').value;
                    let Pontos = document.getElementById('id_pontos').value;
                    alert(`Agora o jogador ${Nickname} tem ${Pontos} pontos`)
                    window.location.href = 'adm.html';
                }
            });
    }

    function mostrarAlerta() {
        let div_alerta = document.getElementById('alerta');
        let bAlerta = document.getElementById('b_alerta');
        let Nickname = document.getElementById('id_nick').value;
        let Pontos = document.getElementById('id_pontos').value;
        div_alerta.style.display = 'block';
        bAlerta.innerHTML = `O jogador ${Nickname} terá ${Pontos} pontos`
    }
    function fecharAlerta() {
        let div_alerta = document.getElementById('alerta');
        div_alerta.style.display = 'none'
    }

    function cancelar() {
        fecharAlerta();
        alert('A operação foi cancelada');
        window.location.href = 'adm.html';
    }

</script>